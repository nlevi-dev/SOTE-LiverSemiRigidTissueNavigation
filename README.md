# Liver Semi-Rigid Tissue Navigation Research Project

## Research Goal

The objective of this research is to determine whether there are regions within the liver that resist deformation, maintaining their internal tissue structure relative to surrounding areas.

## Experiment Description

Excised liver specimens were placed on a deflated balloon in a resting position. The inferior vena cava was stabilized using a plastic tube to preserve the liver’s relative positioning. The balloon was then gradually inflated in small increments while the liver’s tissue structure was tracked using computed tomography (CT) imaging at each inflation step.

To enhance tissue tracking, several dozen radiopaque beads were attached both to the liver’s surface and internally within blood and bile vessels. These beads appear brightly in CT scans, making them easy to track throughout the deformation process.

## Rigidity Computation

### FNIRT Warp Fields

Inspired by FNIRT warp fields, which are commonly used for nonlinear brain registration and normalization, we attempted to construct a similar warp field to model liver tissue behavior between deformation steps. This warp field would map each spatial point in one scan to its corresponding location in the next, potentially allowing for the identification of stable regions within the liver.

FNIRT's approach subdivides space and computes deformations using a mutual information metric. However, applying it directly to liver tissue presented challenges. The algorithm is optimized for brains, and even after tuning hyperparameters for greater flexibility and resolution, it required an unfeasibly large amount of computational resources. Efforts to optimize preprocessing (such as downsampling and cropping to the region of interest) did not resolve these issues.

Additionally, the CT scans had insufficient resolution to capture fine-grained tissue structures, preserving only the fixed beads as reliable landmarks. As a result, the warp field calculations between beads became unstable, with multiple valid solutions meeting the mutual information metric but lacking true anatomical accuracy.

### Warp Field Construction from a Set of Tracked Points

A more practical approach involved constructing warp fields using the tracked bead positions. Since the beads are distributed throughout the liver, they provide a sparse but usable point cloud for warp field generation.

1. Warp Vector Calculation
    * The displacement vectors of the tracked beads were computed between consecutive CT images (denoted as T<sub>0</sub> and T<sub>1</sub>).
    * The warp vector cloud (W<sub>01</sub>) was obtained by subtracting the position vectors of beads in T<sub>0</sub> from their corresponding positions in T<sub>1</sub>: W<sub>01</sub>=T<sub>1</sub>−T<sub>0</sub>
2. Warp Field Interpolation
    * The tracked bead point cloud was converted into a set of tetrahedra using Delaunay tetrahedralization.
    * A volumetric grid representation (similar to a CT scan) was generated by interpolating each voxel within the tetrahedra to create a continuous warp field.
    * Interpolation weights were determined using ray projection:
      * A ray was cast from each tetrahedral vertex through the target voxel point (V) inside the tetrahedron.
      * The ray intersection point (I) on the opposing tetrahedral face was computed.
      * The distance between I and V was used as the interpolation weight.
3. Warp Field Expansion and Stacking
    * Since the interpolated warp field only covered the liver’s internal volume, it was extended beyond the liver’s hull using an "inpainting" technique, where voxels outside the liver were assigned the values of their nearest internal neighbors.
    * The warp fields for successive image pairs were stacked to track deformations across multiple inflation steps. For a transformation from T<sub>0</sub> to T<sub>n</sub> the warp fields were sequentially accumulated: W<sub>0n</sub> = W<sub>01</sub> + mapped W<sub>12</sub> + mapped W<sub>23</sub> + ...
    * To minimize noise and smooth out the values on the edge of the hull, the inpainting step of the external points (outside the liver's hull) was repeatead after each stacking step.
4. Rigidity Metric Computation
    * The magnitude of each warp vector at each voxel was calculated, representing the displacement at that point.
    * A rigidity metric was derived by applying a standard deviation filter (sliding window) to the magnitude image.
    * Higher standard deviation values indicated less rigid tissue (greater deformation variability), while lower values indicated more rigid regions.

## Preliminary Observations and Conclusions

This method effectively constructs warp fields to track large-scale tissue deformations with reasonable accuracy. However, the current approach introduces biases that obscure the research’s true goal.

1. Selection Bias in Deformation Analysis
    * The results primarily highlight the most mobile region, the area directly above the balloon. This masks potential stable regions elsewhere in the liver.
2. Insufficient Variability in Deformations
    * A wider range of deformation types (e.g., different locations, directions, and modalities) and a larger sample size of liver specimens are needed to generalize findings. Increased variation could reveal consistent patterns of rigidity across different conditions.
3. CT Resolution Limitations
    * Current CT imaging is too low in resolution to capture fine-grained tissue structure without beads.
    * Higher-resolution imaging could allow for an additional warp field that tracks tissue movement between beads, capturing the finer details of intra-bead deformation.

### Next Steps

While this research provides a solid foundation, it is not yet a generalized or fully representative solution. To advance this project, the following improvements are necessary:

* Increase deformation variability (different specimen types, locations, and deformation modalities).
* Expand the dataset with more liver specimens to ensure reproducibility and statistical significance.
* Enhance CT imaging resolution to track fine tissue structures without relying solely on beads.

With these improvements, the research can move closer to identifying stable liver regions that resist deformation, ultimately improving semi-rigid tissue navigation techniques for surgical and diagnostic applications.
